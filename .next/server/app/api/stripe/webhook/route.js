(()=>{var e={};e.id=757,e.ids=[757],e.modules={47495:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=47495,e.exports=r},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},29243:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{POST:()=>c});var i=t(49303),o=t(88716),u=t(60670),p=t(87070),a=t(69206);let n=(0,t(40785).createClient)("https://uolpvxgcobjefivqnscj.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function c(e){let r;let t=e.headers.get("stripe-signature"),s=await e.text();try{r=a.Ag.webhooks.constructEvent(s,t,process.env.STRIPE_WEBHOOK_SECRET)}catch(e){return console.error("Webhook signature verification failed.",e),p.NextResponse.json({error:"Invalid signature"},{status:400})}if("account.updated"===r.type){let e=r.data.object,t=e.id;if(e.details_submitted&&e.charges_enabled){let{error:e}=await n.from("riders_details").update({stripe_onboarding_complete:!0}).eq("stripe_account_id",t);if(e)return console.error(`ERRORE nell'aggiornamento Supabase per l'account ${t}:`,e),p.NextResponse.json({received:!0,error:e.message})}}return p.NextResponse.json({received:!0})}let d=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/stripe/webhook/route",pathname:"/api/stripe/webhook",filename:"route",bundlePath:"app/api/stripe/webhook/route"},resolvedPagePath:"/home/dimagio/Applications/bemyrider project/bemyrider_app/bemyrider/app/api/stripe/webhook/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:x,serverHooks:h}=d,m="/api/stripe/webhook/route";function v(){return(0,u.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},69206:(e,r,t)=>{"use strict";t.d(r,{Ag:()=>s});let s=new(t(48472)).Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2023-10-16"})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,785,472],()=>t(29243));module.exports=s})();