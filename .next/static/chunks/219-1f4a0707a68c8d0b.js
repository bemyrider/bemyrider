"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[219],{6087:function(e,t,a){a.d(t,{Z:function(){return y}});var i=a(7437),s=a(2265),r=a(3145),n=a(2869),l=a(5186),o=a(6818),c=a(6070),d=a(6110),u=a(5974),m=a(3113),f=a(2489),p=a(7689),g=a(3327),x=a(9397),h=a(6362),j=a(5863),v=a(3229),N=a(7992),b=a(2141);function y(e){let{initialData:t,onSave:a,onClose:y,isLoading:R=!1}=e,{toast:w}=(0,N.pm)(),_=(0,s.useRef)(null),[O,I]=(0,s.useState)(t.portfolioImages||[]),[z,E]=(0,s.useState)(t.certifications||[]),[k,S]=(0,s.useState)(t.portfolioUrl||""),[U,Z]=(0,s.useState)(t.servicesDescription||""),[A,C]=(0,s.useState)(""),[D,L]=(0,s.useState)(!1),M=async e=>{let t=10-O.length;if(e.length>t){w({title:"Limite raggiunto",description:"Puoi aggiungere massimo ".concat(t," immagini")});return}let a=[];for(let i=0;i<Math.min(e.length,t);i++){let t=e[i];if(t.size>5242880){w({title:"File troppo grande",description:"".concat(t.name," \xe8 troppo grande (max 5MB)")});continue}if(!t.type.startsWith("image/")){w({title:"Tipo file non valido",description:"".concat(t.name," non \xe8 un'immagine valida")});continue}try{let{data:{user:e}}=await b.O.auth.getUser();if(!e){w({title:"Errore",description:"Utente non autenticato"});continue}let i=new FormData;i.append("image",t);let s=await fetch("/api/riders/".concat(e.id,"/portfolio"),{method:"POST",body:i});if(!s.ok){let e=await s.json();throw Error(e.error||"Upload fallito")}let r=await s.json();a.push(r.imageUrl)}catch(e){console.error("Errore upload immagine:",e),w({title:"Errore upload",description:e.message||"Errore durante l'upload dell'immagine"});continue}}a.length>0&&(I(e=>[...e,...a]),w({title:"Immagini aggiunte",description:"Aggiunte ".concat(a.length," immagini al portfolio")}))},P=e=>{I(t=>{let a=[...t];return URL.revokeObjectURL(a[e]),a.splice(e,1),a})},H=()=>{let e=A.trim();e&&!z.includes(e)&&(E(t=>[...t,e]),C(""))},Y=e=>{E(t=>t.filter(t=>t!==e))},B=async()=>{try{if(L(!0),k&&!k.match(/^https?:\/\/.+/)){w({title:"Invalid URL",description:"URL must start with http:// or https://"});return}let e={portfolioImages:O,certifications:z,portfolioUrl:k.trim(),servicesDescription:U.trim()};await a(e),w({title:"Portfolio salvato",description:"Le modifiche sono state salvate con successo"}),y()}catch(e){console.error("Errore nel salvataggio del portfolio:",e),w({title:"Error",description:"An error occurred while saving"})}finally{L(!1)}};return(0,i.jsx)(d.Vq,{open:!0,onOpenChange:y,children:(0,i.jsxs)(d.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,i.jsxs)(d.fK,{children:[(0,i.jsx)(d.$N,{className:"text-xl",children:"Modifica Portfolio"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Gestisci le tue immagini, certificazioni e descrizione dei servizi"})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)(c.Zb,{children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsxs)(c.ll,{className:"text-lg flex items-center",children:[(0,i.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),"Immagini Portfolio"]}),(0,i.jsxs)(c.SZ,{children:["Aggiungi fino a 10 immagini per mostrare il tuo lavoro (",O.length,"/10)"]})]}),(0,i.jsxs)(c.aY,{className:"space-y-4",children:[O.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:O.map((e,t)=>(0,i.jsx)("div",{className:"relative group",children:(0,i.jsxs)("div",{className:"aspect-square relative rounded-lg overflow-hidden border",children:[(0,i.jsx)(r.default,{src:e,alt:"Portfolio ".concat(t+1),fill:!0,className:"object-cover",sizes:"(max-width: 768px) 50vw, 33vw"}),(0,i.jsx)(n.z,{variant:"destructive",size:"sm",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>P(t),children:(0,i.jsx)(f.Z,{className:"h-4 w-4"})})]})},t))}),O.length<10&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{ref:_,type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:e=>e.target.files&&M(e.target.files)}),(0,i.jsxs)(n.z,{variant:"outline",onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},className:"w-full border-dashed border-2",children:[(0,i.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Aggiungi Immagini"]})]}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"Formati supportati: JPG, PNG, WebP. Dimensione massima: 5MB per immagine."})]})]}),(0,i.jsxs)(c.Zb,{children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsxs)(c.ll,{className:"text-lg flex items-center",children:[(0,i.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),"Certificazioni"]}),(0,i.jsx)(c.SZ,{children:"Aggiungi le tue certificazioni e qualifiche professionali"})]}),(0,i.jsxs)(c.aY,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(l.I,{placeholder:"Es: Patente B, Corso Sicurezza, etc.",value:A,onChange:e=>C(e.target.value),onKeyPress:e=>"Enter"===e.key&&H()}),(0,i.jsx)(n.z,{onClick:H,disabled:!A.trim(),children:(0,i.jsx)(x.Z,{className:"h-4 w-4"})})]}),z.length>0&&(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:z.map((e,t)=>(0,i.jsxs)(u.C,{variant:"secondary",className:"text-sm",children:[e,(0,i.jsx)(n.z,{variant:"ghost",size:"sm",className:"ml-2 h-4 w-4 p-0 hover:bg-red-100",onClick:()=>Y(e),children:(0,i.jsx)(f.Z,{className:"h-3 w-3"})})]},t))})]})]}),(0,i.jsxs)(c.Zb,{children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsxs)(c.ll,{className:"text-lg flex items-center",children:[(0,i.jsx)(h.Z,{className:"h-5 w-5 mr-2"}),"Portfolio Online"]}),(0,i.jsx)(c.SZ,{children:"Link al tuo portfolio/website esterno (opzionale)"})]}),(0,i.jsx)(c.aY,{children:(0,i.jsx)(l.I,{type:"url",placeholder:"https://tuoportfolio.com",value:k,onChange:e=>S(e.target.value)})})]}),(0,i.jsxs)(c.Zb,{children:[(0,i.jsxs)(c.Ol,{children:[(0,i.jsx)(c.ll,{className:"text-lg",children:"Descrizione Servizi"}),(0,i.jsx)(c.SZ,{children:"Descrivi i servizi che offri e la tua esperienza"})]}),(0,i.jsxs)(c.aY,{children:[(0,i.jsx)(o.g,{placeholder:"Descrivi i tuoi servizi, la tua esperienza e ci\xf2 che ti rende speciale...",value:U,onChange:e=>Z(e.target.value),rows:4,maxLength:1e3}),(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[U.length,"/1000 caratteri"]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,i.jsx)(n.z,{variant:"outline",onClick:y,disabled:D,children:"Annulla"}),(0,i.jsx)(n.z,{onClick:B,disabled:D,children:D?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Salva Portfolio"]})})]})]})]})})}},5974:function(e,t,a){a.d(t,{C:function(){return l}});var i=a(7437);a(2265);var s=a(535),r=a(4508);let n=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...s}=e;return(0,i.jsx)("div",{className:(0,r.cn)(n({variant:a}),t),...s})}},6110:function(e,t,a){a.d(t,{$N:function(){return f},Vq:function(){return o},cZ:function(){return u},fK:function(){return m}});var i=a(7437),s=a(2265),r=a(794),n=a(2489),l=a(4508);let o=r.fC;r.xz;let c=r.h_;r.x8;let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(r.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});d.displayName=r.aV.displayName;let u=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,i.jsxs)(c,{children:[(0,i.jsx)(d,{}),(0,i.jsxs)(r.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,i.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=r.VY.displayName;let m=e=>{let{className:t,...a}=e;return(0,i.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(r.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});f.displayName=r.Dx.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(r.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})}).displayName=r.dk.displayName},6818:function(e,t,a){a.d(t,{g:function(){return n}});var i=a(7437),s=a(2265),r=a(4508);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});n.displayName="Textarea"},8685:function(e,t,a){a.d(t,{P0:function(){return s},Pz:function(){return r},RZ:function(){return n},SI:function(){return i}});let i={MAX_RIDER_HOURLY_RATE:12.5,MAX_BOOKING_HOURS:2,MIN_RIDER_HOURLY_RATE:5,MIN_BOOKING_HOURS:1},s=e=>e>=i.MIN_RIDER_HOURLY_RATE&&e<=i.MAX_RIDER_HOURLY_RATE,r=e=>e>=i.MIN_BOOKING_HOURS&&e<=i.MAX_BOOKING_HOURS,n={INVALID_RIDER_RATE:"La tariffa oraria deve essere compresa tra €".concat(i.MIN_RIDER_HOURLY_RATE," e €").concat(i.MAX_RIDER_HOURLY_RATE),INVALID_BOOKING_HOURS:"Le ore di prenotazione devono essere comprese tra ".concat(i.MIN_BOOKING_HOURS," e ").concat(i.MAX_BOOKING_HOURS)}}}]);