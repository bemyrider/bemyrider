(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{7129:function(e,r,t){Promise.resolve().then(t.bind(t,1720))},1720:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return i}});var o=t(7437),n=t(2265),s=t(9376),u=t(2141);function i(){let e=(0,s.useRouter)();return(0,n.useEffect)(()=>{(async()=>{try{let{data:{user:r},error:t}=await u.O.auth.getUser();if(t||!r){console.log("\uD83D\uDEAB No authenticated user, redirecting to login"),e.push("/auth/login");return}console.log("\uD83D\uDC64 Authenticated user found:",r.id,"Email:",r.email);let{data:o,error:n}=await u.O.from("profiles").select("role").eq("id",r.id).single();if(n){if("PGRST116"===n.code){console.log("\uD83D\uDCDD No profile found, redirecting to registration"),e.push("/auth/register");return}console.error("❌ Error fetching profile:",n),e.push("/auth/login");return}console.log("\uD83D\uDCCB Profile found, role:",o.role),"merchant"===o.role?(console.log("➡️ Redirecting to merchant dashboard"),e.push("/dashboard/merchant")):"rider"===o.role?(console.log("➡️ Redirecting to rider dashboard"),e.push("/dashboard/rider")):(console.log("❓ Unknown role, redirecting to registration"),e.push("/auth/register"))}catch(r){console.error("\uD83D\uDCA5 Unexpected error during redirect:",r),e.push("/auth/login")}})()},[e]),(0,o.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),(0,o.jsx)("p",{className:"mt-4 text-gray-600",children:"Reindirizzamento..."})]})})}},2141:function(e,r,t){"use strict";t.d(r,{O:function(){return o}});let o=(0,t(5214).createBrowserClient)("https://uolpvxgcobjefivqnscj.supabase.co","sb_publishable_XfZivZLXatSeakd_ccimng_ZiTnn0dN")},9376:function(e,r,t){"use strict";var o=t(5475);t.o(o,"useParams")&&t.d(r,{useParams:function(){return o.useParams}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(r,{useSearchParams:function(){return o.useSearchParams}})}},function(e){e.O(0,[214,971,117,744],function(){return e(e.s=7129)}),_N_E=e.O()}]);